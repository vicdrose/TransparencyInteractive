<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Optimizing the Size of the Built iOS Player</title>
<meta name="description" content="The Unity Manual helps you learn and use the Unity engine. With the Unity engine you can create 2D and 3D games, apps and experiences.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2854981-1']);
  _gaq.push(['_setDomainName', 'unity3d.com']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1492779482"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1492779482"></script><script type="text/javascript" src="docdata/toc.js?ts=1492779482"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1492779482"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1492779482">
</head>
<body>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="http://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>5.6</b> (<a href="https://docs.unity3d.com/2017.1/Documentation/Manual">switch to 2017.1b</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/iphone-playerSizeOptimization.html">English</a></li>
<li><a href="/ja/current/Manual/iphone-playerSizeOptimization.html">日本語</a></li>
<li><a href="/es/current/Manual/iphone-playerSizeOptimization.html">Español</a></li>
<li><a href="/kr/current/Manual/iphone-playerSizeOptimization.html">한국어</a></li>
<li><a href="/ru/current/Manual/iphone-playerSizeOptimization.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (5.6)</a></li>
<li><a href="PlatformSpecific.html">Platform-specific</a></li>
<li><a href="iphone.html">iOS</a></li>
<li>iOS Advanced Topics</li>
<li><a href="iphone-performance.html">Optimizing Performance in iOS.</a></li>
<li>Optimizing the Size of the Built iOS Player</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="iphone-InternalProfiler.html"></a></span><div class="tip">Measuring Performance with the Built-in Profiler</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="iphone-Optimizing-Physics.html"></a></span><div class="tip">Optimizing Physics Performance</div>
</div>
</div></div>
<h1>Optimizing the Size of the Built iOS Player</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>The two main ways of reducing the size of the player are by making proper <strong>Release build</strong> within Xcode and by changing the <strong>Stripping Level</strong> within Unity.</p>

<h2>Building for distribution</h2>

<p>It is expected that final release builds are made using Xcode 4.x/5.x command <strong>Product -&gt; Archive</strong>. Using this command ensures that build is made with release configuration <strong>and</strong> all the debug symbols are stripped.
After issuing this command latest Xcode switches to Organizer window <strong>Archives</strong> tab (you can navigate there manually via <em>Window -&gt; Organizer</em> menu). You will find there two very useful functions there: <strong>App Store size estimation</strong> and <strong>Distribution</strong>.
Build size estimation function works pretty well, but it is always recommended to have some small extra margin for error when aiming for 3G download limit (which currently is 100MB).</p>

<h2>iOS Stripping Level</h2>

<p>The size optimizations activated by stripping work in the following way:</p>

<ol>
<li><p>
<strong>Strip assemblies</strong> level: the scripts’ bytecode is analyzed so that classes and methods that are not referenced from the scripts can be removed from the DLLs and thereby excluded from the AOT compilation phase. This optimization reduces the size of the main binary and accompanying DLLs and is safe as long as no reflection is used.</p></li>
<li><p>
<strong>Strip ByteCode</strong> level: any .NET DLLs (stored in the Data folder) are stripped down to metadata only. This is possible because all the code is already precompiled during the AOT phase and linked into the main binary.</p></li>
<li><p>
<strong>Use micro mscorlib</strong> level: a special, smaller version of mscorlib is used. Some components are removed from this library, for example, Security, Reflection.Emit, Remoting, non Gregorian calendars, etc. Also, interdependencies between internal components are minimized. This optimization reduces the main binary and mscorlib.dll size but it is not compatible with some System and System.Xml assembly classes, so use it with care.</p></li>
</ol>

<p>These levels are cumulative, so level 3 optimization implicitly includes levels 2 and 1, while level 2 optimization includes level 1.</p>

<p>Note that <strong>Micro mscorlib</strong> is a heavily stripped-down version of the core library. Only those items that are required by the Mono runtime in Unity remain. Best practice for using micro mscorlib is not to use any classes or other features of .NET that are not required by your application. GUIDs are a good example of something you could omit; they can easily be replaced with custom made pseudo GUIDs and doing this would result in better performance and app size. </p>

<h2>Stripping with IL2CPP</h2>

<p>The equivalent of <strong>Strip ByteCode</strong> is always enabled when the IL2CPP scripting backend is used. In this case, the <strong>Stripping Level</strong> option is replaced with an Boolean option named <strong>Strip Engine Code</strong>. If this option is enabled, unused modules and classes in the Unity Engine code will be removed, if it is disabled, all of the modules and classes in the Unity Engine code will be preserved.</p>

<p>The <strong>link.xml</strong> file (described below) can be used to effectively disable byte code stripping by preserving both types and full assemblies. For example, to prevent the <strong>System</strong> assembly from being stripped, the following link.xml file can be used:</p>

<pre><code>&lt;linker&gt;
       &lt;assembly fullname=&quot;System&quot; preserve=&quot;all&quot;/&gt;
&lt;/linker&gt;
</code></pre>

<p>
<strong>Note:</strong> The ability to preserve an entire assembly applies only to the IL2CPP scripting backend.</p>

<h2>Tips</h2>

<h3>How to Deal with Stripping when Using Reflection</h3>

<p>Stripping depends highly on static code analysis and sometimes this can’t be done effectively, especially when dynamic features like reflection are used. In such cases, it is necessary to give some hints as to which classes shouldn’t be touched. Unity supports a per-project custom stripping <em>blacklist</em>. Using the blacklist is a simple matter of creating a <strong>link.xml</strong> file and placing it into the <strong>Assets</strong> folder (or any subdirectory of <strong>Assets</strong>). An example of the contents of the <strong>link.xml</strong> file follows. Classes marked for preservation will not be affected by stripping:</p>

<pre><code>&lt;linker&gt;
       &lt;assembly fullname=&quot;System.Web.Services&quot;&gt;
               &lt;type fullname=&quot;System.Web.Services.Protocols.SoapTypeStubInfo&quot; preserve=&quot;all&quot;/&gt;
               &lt;type fullname=&quot;System.Web.Services.Configuration.WebServicesConfigurationSectionHandler&quot; preserve=&quot;all&quot;/&gt;
       &lt;/assembly&gt;

       &lt;assembly fullname=&quot;System&quot;&gt;
               &lt;type fullname=&quot;System.Net.Configuration.WebRequestModuleHandler&quot; preserve=&quot;all&quot;/&gt;
               &lt;type fullname=&quot;System.Net.HttpRequestCreator&quot; preserve=&quot;all&quot;/&gt;
               &lt;type fullname=&quot;System.Net.FileWebRequestCreator&quot; preserve=&quot;all&quot;/&gt;
       &lt;/assembly&gt;

       &lt;assembly fullname=&quot;mscorlib&quot;&gt;
               &lt;type fullname=&quot;System.AppDomain&quot; preserve=&quot;fields&quot;/&gt;
               &lt;type fullname=&quot;System.InvalidOperationException&quot; preserve=&quot;fields&quot;&gt;
                       &lt;method signature=&quot;System.Void .ctor()&quot;/&gt;
               &lt;/type&gt;
               &lt;type fullname=&quot;System.Object&quot; preserve=&quot;nothing&quot;&gt;
                      &lt;method name=&quot;Finalize&quot;/&gt;
               &lt;/type&gt;
       &lt;/assembly&gt;
&lt;/linker&gt;
</code></pre>

<p>A project can include multiple <strong>link.xml</strong> files. Each <strong>link.xml</strong> file can specify a number of different options.</p>

<ul>
<li>The <strong>assembly</strong> element indicates the managed assembly where the nested directives should apply.</li>
<li>The <strong>type</strong> element is used to indicate how a specific type should be handled. It must be a child of the <strong>assembly</strong> element. The <strong>fullname</strong> attribute can accept the ‘*’ wild card to match one or more characters.</li>
<li>The <strong>preserve</strong> attribute can take on one of three values:

<ul>
<li>
<strong>all</strong>: Keep everything from the given type (or assembly, for IL2CPP only).</li>
<li>
<strong>fields</strong>: Keep only the fields of the given type.</li>
<li>
<strong>nothing</strong>: Keep only the given type, bug none of its contents.</li>
</ul>
</li>
<li>The <strong>method</strong> element is used to indicate that a specific method should be preserved. It must be a child of the <strong>type</strong> element. The method can be specified by name or by signature.</li>
</ul>

<p>The stripped assemblies are output to a directory below the <strong>Temp</strong> directory in the project (the exact location varies depending on the target platform). The original, unstripped assemblies are available in the <strong>not-stripped</strong> directory in the same location as the stripped assemblies. A tool like <a href="http://ilspy.net/">ILSpy</a> can be used to inspect the stripped and unstripped assemblies to determine what parts of the code were removed.</p>

<p>
<strong>Note:</strong> it can sometimes be difficult to determine which classes are getting stripped in error even though the application requires them. You can often get useful information about this by running the stripped application on the simulator and checking the Xcode console for error messages.</p>

<h3>Simple Checklist for Making Your Distribution as Small as Possible</h3>

<ol>
<li>Minimize your assets: enable PVRTC compression for textures and reduce their resolution as far as possible. Also, minimize the number of uncompressed sounds. There are some additional tips for file size reduction <a href="ReducingFilesize.html">here</a>.</li>
<li>Set the iOS Stripping Level to <strong>Use micro mscorlib</strong>.</li>
<li>Set the script call optimization level to <strong>Fast but no exceptions</strong>.</li>
<li>Don’t use anything that lives in System.dll or System.Xml.dll in your code. These libraries are <strong>not</strong> compatible with micro mscorlib.</li>
<li>Remove unnecessary code dependencies.</li>
<li>Set the API Compatibility Level to <strong>.Net 2.0 subset</strong>. Note that .Net 2.0 subset has limited compatibility with other libraries.</li>
<li>Don’t use JS Arrays.</li>
<li>Avoid generic containers in combination with value types, including structs.</li>
</ol>

<h3>How small can an app be made with Unity?</h3>

<p>An empty project would take less than 22 MB in the App Store if all the size optimizations were turned off. With code stripping, the empty scene with just the main camera can be reduced to less than 12 MB in the App Store (zipped and DRM attached). </p>

<h3>Why did my app increase in size after being released to the App Store?</h3>

<p>When publishing your app, Apple App Store service first encrypts the binary file and then compresses it via zip. Encryption increases ’‘randomness’ of the code segment and thus makes it worse for compression. Check “Building for distribution” chapter above how to estimate App Store size before submission.</p>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="iphone-InternalProfiler.html"></a></span><div class="tip">Measuring Performance with the Built-in Profiler</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="iphone-Optimizing-Physics.html"></a></span><div class="tip">Optimizing Physics Performance</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">
<known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="http://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues>Copyright © 2017 Unity Technologies. Publication: 5.6-001I. Built: 2017-04-21.</div>
<div class="menu">
<a href="http://unity3d.com/learn">Tutorials</a><a href="http://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="http://forum.unity3d.com">Forums</a><a href="http://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
<noscript><iframe src="http://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MC35ML');</script>
</body>
</html>
