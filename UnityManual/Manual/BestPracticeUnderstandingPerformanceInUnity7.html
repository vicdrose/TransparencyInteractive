<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  General Optimizations</title>
<meta name="description" content="The Unity Manual helps you learn and use the Unity engine. With the Unity engine you can create 2D and 3D games, apps and experiences.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-2854981-1']);
  _gaq.push(['_setDomainName', 'unity3d.com']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1492779482"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1492779482"></script><script type="text/javascript" src="docdata/toc.js?ts=1492779482"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1492779482"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1492779482">
</head>
<body>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="http://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="http://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>5.6</b> (<a href="https://docs.unity3d.com/2017.1/Documentation/Manual">switch to 2017.1b</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">English</a></li>
<li><a href="/ja/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">日本語</a></li>
<li><a href="/es/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">Español</a></li>
<li><a href="/kr/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">한국어</a></li>
<li><a href="/ru/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (5.6)</a></li>
<li><a href="BestPracticeGuides.html"> Best practice guides</a></li>
<li><a href="BestPracticeUnderstandingPerformanceInUnity.html"> Understanding optimization in Unity</a></li>
<li> General Optimizations</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="BestPracticeUnderstandingPerformanceInUnity6.html"></a></span><div class="tip"> The Resources folder</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="BestPracticeUnderstandingPerformanceInUnity8.html"></a></span><div class="tip"> Special optimizations</div>
</div>
</div></div>
<h1>General Optimizations</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>There are as many different ways to optimize code as there are reasons for performance problems. In general, it is strongly recommended that developers closely profile their applications before attempting to apply CPU optimizations. However, there are several simple CPU optimizations that are universally applicable.</p>

<h2>Address Properties by ID</h2>

<p>Unity does not use string names to address Animator, Material and Shader properties internally. For speed, all property names are hashed into property IDs, and it is these IDs that are actually used to address the properties.</p>

<p>Therefore, whenever using a <em>Set</em> or <em>Get</em> method on an Animator, Material or Shader, use the integer-valued method instead of the string-valued methods. The string methods simply perform string hashing and then forward the hashed ID to the integer-valued methods.</p>

<p>The property IDs created from string hashes are deterministic over the course of a single run. The simplest way to use them is to declare a static read-only integer variable for each property name, and use the integer variable in place of the string. These are automatically initialized during startup with no further initialization code needed.</p>

<p>The appropriate APIs are <a href="../ScriptReference/Animator.StringToHash.html">Animator.StringToHash</a> for Animator property names, and <a href="../ScriptReference/Shader.PropertyToID.html">Shader.PropertyToID</a> for Material &amp; Shader property names.</p>

<h2>Use non-allocating physics APIs</h2>

<p>In Unity 5.3 and onwards, non-allocating versions of all Physics query APIs have been introduced. Replace <a href="../ScriptReference/Physics.RaycastAll.html">RaycastAll</a> calls with <a href="../ScriptReference/Physics.RaycastNonAlloc.html">RaycastNonAlloc</a>, <a href="../ScriptReference/Physics.SphereCastAll.html">SphereCastAll</a> calls with <a href="../ScriptReference/Physics.SphereCastNonAlloc.html">SphereCastNonAlloc</a>, and so on. For 2D applications, there are also non-allocating versions of all Physics2D query APIs.</p>

<h2>Transform manipulation</h2>

<p>Whenever a Transform’s position or rotation is changed, an <code>OnTransformChanged</code> message is dispatched to all components on the same GameObject as the Transform, as well as all child GameObjects. For this reason, it is best practice to attempt to alter a Transform’s position and rotation as few times as possible during a given frame. Instead, batch all possible changes that need to be applied to the Transform, and apply them once. This minimizes the number of <code>OnTransformChanged</code> messages that must propagate through the Transform hierarchy, and is especially important when moving deep/large Transform hierarchies, such as animated characters.</p>

<h3>Vector and quaternion math and order of operations</h3>

<p>For vector and quaternion math that is located in tight loops, remember that integer math is faster than floating-point math, and floating-point math is faster than vector, matrix or quaternion math.</p>

<p>Therefore, whenever commutative or associative arithmetic allows, attempt to minimize the cost of individual mathematical operations:</p>

<pre><code>
Vector3 x;

int a, b;

// Less efficient: results in two vector multiplications

Vector3 slow = a * x * b;

// More efficient: one integer mult, one vector mult

Vector3 fast = a * b * x;

</code></pre>

<h2>Built-In ColorUtility</h2>

<p>It is common for applications that must convert between HTML-formatted color strings (<code>#RRGGBBAA</code>) and Unity’s native <code>Color</code> and <code>Color32</code> structures to use a script from the Unify Community. This script was both slow and caused extensive memory allocation due to string manipulation.</p>

<p>As of Unity 5, there is a built-in <a href="../ScriptReference/ColorUtility.html">ColorUtility</a> API that performs these conversions efficiently. Usage of the built-in API should be preferred.</p>

<h2>Find and FindObjectOfType</h2>

<p>It is a general best practice to eliminate all usage of <code>Object.Find</code> and <code>Object.FindObjectOfType</code> in production code. As these APIs require Unity to iterate over all GameObjects and Components in memory, they rapidly become non-performant as the scope of a project grows.</p>

<p>An exception to the above rule can be made in accessors for singleton objects. A global manager object often exposes an “instance” property, and often has a <code>FindObjectOfType</code> call in the getter to detect pre-existing instances of the singleton:</p>

<pre><code>
class SomeSingleton {

    private SomeSingleton _instance;

    public SomeSingleton Instance {

        get {

            if(_instance == null) { 

                _instance =

                    FindObjectOfType&lt;SomeSingleton&gt;(); 

            }

            if(_instnace == null) { 

                _instance = CreateSomeSingleton();

            }

            return _instance;

        }

    }

}

</code></pre>

<p>While this pattern is generally acceptable, it is important to examine the code and ensure that the accessor is be called in Scenes where the singleton object does not exist. If the getter does not automatically create an instance of a missing singleton, it is very common to discover that code looking for the singleton results in repeated calls to <code>FindObjectOfType</code> (often multiple times per frame) and creates an undesirable drain on performance.</p>

<h3>Camera locators</h3>

<p>Internally, Unity’s <code>Camera.main</code> property calls <code>Object.FindObjectWithTag</code>, a specialized variant of <code>Object.FindObject</code>. Accessing this property is no more efficient than a call to <code>Object.FindObjectOfType</code>. If code must address the main camera, it is strongly recommended to do one of two things:</p>

<ul>
<li><p>Access <code>Camera.main</code> in a <code>Start</code> or<code>OnEnable</code> callback and cache the resulting reference.</p></li>
<li><p>Construct a <code>Camera Manager</code> class that can provide or inject a reference to the active camera.</p></li>
</ul>

<h2>Debug code &amp; the [conditional] attribute</h2>

<p>The <code>UnityEngine.Debug</code> logging APIs are not stripped from non-development builds, and do write to log files if called. As most developers do not intend to write debug information in non-development builds, it is recommended to wrap development-only logging calls in custom methods, like so:</p>

<pre><code>
    public static class Logger {

        [Conditional(&quot;ENABLE_LOGS&quot;)]

        public void Debug(string logMsg) {

            Debug.Log(logMsg);

        }

    }

</code></pre>

<p>By decorating these methods with the [Conditional] attribute, the define or defines used by the Conditional attribute determine whether the decorated method is included in the compiled source.</p>

<p>If none of the defines passed to the Conditional attribute are defined, then the decorated method <em>and</em> all calls to the decorated method are compiled out. The effect is identical to what would happen if the method and all calls to the method were wrapped in <code>#if … #endif</code> preprocessor blocks.</p>

<p>For more information on the <code>Conditional</code> attribute, see the MSDN website: <a href="https://msdn.microsoft.com/en-us/library/4xssyw96(v=vs.90).aspx">msdn.microsoft.com</a>.</p>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="BestPracticeUnderstandingPerformanceInUnity6.html"></a></span><div class="tip"> The Resources folder</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="BestPracticeUnderstandingPerformanceInUnity8.html"></a></span><div class="tip"> Special optimizations</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">
<known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="http://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues>Copyright © 2017 Unity Technologies. Publication: 5.6-001I. Built: 2017-04-21.</div>
<div class="menu">
<a href="http://unity3d.com/learn">Tutorials</a><a href="http://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="http://forum.unity3d.com">Forums</a><a href="http://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
<noscript><iframe src="http://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'http://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MC35ML');</script>
</body>
</html>
